<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Lista preguntas</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

</head>
<body class="container py-4">

<h1 class="mb-4">Preguntas y respuestas</h1>

<table class="table table-striped table-hover align-middle">
    <thead class="table-dark">
    <tr>
        <th class="w-75">Pregunta</th>
        <th class="w-25 text-end">Acciones</th>
    </tr>
    </thead>

    <tbody>
    <tr th:each="p : ${preguntas}">
        <!-- Label con el enunciado -->
        <td class="fw-semibold align-top">
            <label th:for="${'respuesta-' + p.id}" th:text="${p.enunciado}"></label>

            <form th:action="@{/pregunta/enviar/{id}(id=${p.id})}" method="post" class="mt-2">
            <textarea
                    th:id="${'respuesta-' + p.id}"
                    name="respuesta"
                    class="form-control mb-2"
                    rows="3"
                    placeholder="Escribe tu respuesta..."
                    required></textarea>
            </form>
        </td>

        <td class="text-end align-top">
            <div class="btn-group" role="group" aria-label="Acciones">

                <!-- Formulario de enviar -->
                <form th:action="@{/pregunta/enviar/{id}(id=${p.id})}" method="post">
                    <button class="btn btn-success" type="submit">Enviar</button>
                </form>

                <!-- Formulario de borrar -->
                <form th:action="@{/pregunta/borrar/{id}(id=${p.id})}" method="post">
                    <button class="btn btn-danger" type="submit"
                            onclick="return confirm('Â¿Seguro que quieres borrar esta pregunta?')">
                        Borrar
                    </button>
                </form>

            </div>
        </td>

    </tr>
    </tbody>
</table>
<script>

    async function obtenerPreguntas() {
        try {
            let response = await fetch('http://localhost:8080/api/preguntarespuesta');

            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            const data = await response.json();
            console.log(data);

        } catch (error) {
            console.error('Error:', error);
        }
    }
</script>

<!-- Bootstrap JS (opcional, por si usas modales u otras funciones) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
